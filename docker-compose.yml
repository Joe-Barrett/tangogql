version: "3"
services:
  tangoql:
    build: .
    restart: always
    command: /bin/bash -c "source activate graphql && adev runserver tangogql/aioserver.py --app-factory=build_server --port=5004"
    ports:
      - "5004:5004"
    volumes:
      - .:/python3-taurus-core/web-maxiv-graphql
    environment:
      - TANGO_HOST=w-v-kitslab-csdb-0:10000
      - PYTHONUNBUFFERED=1
    logging:
      driver: "syslog"
      options:
        syslog-address: "tcp://w-v-log-0:5000"
  auth:
    image: webjive-auth
    ports:
      - "8080:8080"
    environment:
      - "REDIS_HOST=redis"
    volumes:
      - "./.env:/var/app/.env"
  redis:
    image: redis
    ports:
      - "6379:6379"
